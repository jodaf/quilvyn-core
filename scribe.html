<!--
The Scribe Character Editor is Copyright 2019, James J. Hayes

This program is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation; either version 2 of the License, or (at your option)
any later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc., 59
Temple Place, Suite 330, Boston, MA 02111-1307 USA.
-->
<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Scribe Program Window</title>

<script>
<!--

/*
 * A few user preferences you may want to change: the background color for
 * Scribe's windows; the default character sheet format; the portion of a
 * common menu/character sheet that the menu occupies (Scribe opens separate
 * windows if this is outside the range 10..90); whether or not to warn when
 * you're about to lose changes made to the current character because you're
 * opening a new one.
 */
var BACKGROUND = 'wheat';
var DEFAULT_SHEET_STYLE = 'Standard';
var MENU_WIDTH_PERCENT = 30;
var WARN_ABOUT_DISCARD = true;

/*
 * Scribe incorporates the modules listed in CUSTOMIZATION_URLS as part of its
 * initial loading; you should uncomment those elements that you want to make
 * part of your Scribe installation and comment or delete the ones you don't
 * want.  If any of the elements of CUSTOMIZATION_URLS begins with a question
 * mark (e.g., '?SRD35PrestigeNPC.js'), Scribe will prompt the user on start-up
 * to ask whether to include the rules from that module.  This can be useful
 * for rules that you use occasionally but don't want always present.  For
 * example, you might want to put a question mark before SRD35PrestigeNPC.js to
 * occasionally use the rules to define NPC- or prestige-class NPCs.  null
 * elements are ignored, so the null value at the end of the array makes it
 * easy to add and remove elements without worrying about a trailing comma.
 */
var CUSTOMIZATION_URLS = [
  'srd35/SRD35.js',
  // 'srd35/SRD35NPC.js',
  // 'srd35/SRD35Prestige.js',
  'srd35/Experience.js',
  'srd35/SRD35SpellDescriptions.js',
  'srd35/CustomSpellPoints.js',
  // 'plugins/Eberron.js',
  // 'plugins/EberronPrestige.js',
  // 'plugins/FirstEdition.js',
  // 'plugins/LastAge.js',
  // 'plugins/LastAgePrestige.js',
  // 'plugins/Pathfinder.js',
  // 'plugins/PathfinderPrestige.js',
  // 'plugins/Realms.js',
  // 'plugins/RealmsPrestige.js',
  // 'plugins/HybridD20.js',
  // 'plugins/FiveE.js',
  null
];

/*
 * If this file defines a CustomizeScribe function, Scribe calls it after
 * loading, allowing you to add custom behavior to the program.  See
 * scribedoc.html for details.  The default implementation below can be used
 * without modification or can be tailored for your installation.
 */
function CustomizeScribe() {
  // The first part of this implementation provides an easy way to define
  // subfeats and subskills (e.g., Weapon Focus (Longbow), Craft (Alchemy))
  // in the SRD35 and Pathfinder rule sets.  Each element of the
  // subfeats/subskills variables gives a feat/skill and a slash-delimited list
  // of subfeat targets.  Modify the values in each list to determine which
  // subfeats/subskills are defined in your Scribe installation.
  var subfeats = {
    'Greater Weapon Focus':'',
    'Greater Weapon Specialization':'',
    'Improved Critical':'Dwarven Waraxe/Longbow/Longsword',
    'Master Craftsman':'', // Pathfinder only
    'Skill Focus':'',
    'Weapon Focus':'Dwarven Waraxe/Longbow/Longsword',
    'Weapon Proficiency':'Simple',
    'Weapon Specialization':'Dwarven Waraxe/Longbow/Longsword'
  };
  var subskills = {
    'Craft':'Alchemy',
    'Profession':''
  };
  if(window.Pathfinder) {
    Object.assign(Pathfinder.SUBFEATS, subfeats);
    Object.assign(Pathfinder.SUBSKILLS, subskills);
  }
  delete subfeats['Master Craftsman'];
  Object.assign(SRD35.SUBFEATS, subfeats);
  Object.assign(SRD35.SUBSKILLS, subskills);
  // The second part loads the modules listed in CUSTOMIZATION_URLS by
  // calling a function with the same name as the module (e.g., it calls
  // SRD35() for SRD35.js).
  for(var i = 0; i < CUSTOMIZATION_URLS.length; i++) {
    var url = CUSTOMIZATION_URLS[i];
    if(url == null)
      continue;
    var func = url.replace(/.*\/|\..*/g, '');
    if(window[func] == null)
      alert('Unable to invoke ' + func + ' from ' + url);
    else
      window[func]();
  }
  // The third part applies specific customizations to the rules.
  if(window.Experience != null) {
    Experience.experienceRules(SRD35.rules);
    if(window.Eberron != null)
      Experience.experienceRules(Eberron.rules);
    if(window.LastAge != null)
      Experience.experienceRules(LastAge.rules);
    if(window.Pathfinder != null)
      Experience.experienceRules(Pathfinder.rules);
    if(window.Realms != null)
      Experience.experienceRules(Realms.rules);
  }
  if(window.CustomSpellPoints != null) {
    CustomSpellPoints.spellPointRules(SRD35.rules);
    if(window.Eberron != null)
      CustomSpellPoints.spellPointRules(Eberron.rules);
    if(window.Pathfinder != null)
      CustomSpellPoints.spellPointRules(Pathfinder.rules);
    if(window.Realms != null)
      CustomSpellPoints.spellPointRules(Realms.rules);
  }
  if(window.SRD35SpellDescriptions != null) {
    SRD35SpellDescriptions.spellRules(SRD35.rules);
    if(window.Eberron != null) {
      SRD35SpellDescriptions.spellRules(Eberron.rules, null, Object.assign({}, SRD35SpellDescriptions.descriptions, Eberron.spellsDescriptions));
    }
    if(window.LastAge != null) {
      SRD35SpellDescriptions.spellRules(LastAge.rules, null, Object.assign({}, SRD35SpellDescriptions.descriptions, LastAge.spellsDescriptions));
    }
    if(window.Pathfinder != null) {
      SRD35SpellDescriptions.spellRules(Pathfinder.rules);
    }
    if(window.Realms != null) {
      SRD35SpellDescriptions.spellRules(Realms.rules, null, Object.assign({}, SRD35SpellDescriptions.descriptions, Realms.spellsDescriptions));
    }
  }
}

/**** Commands that load the Scribe software.  Do not modify. ****/

const CLOSE_TAG = '<' + '/' + 'script>\n';
const HELP_URL = 'core/scribedoc.html';
const LOGO_URL = 'core/scribe.gif';
var scribeUrls = [
  'core/Input.js', 'core/ObjectViewer.js', 'core/RuleEngine.js',
  'core/ScribeUtils.js', 'core/Scribe.js', 'core/ScribeRules.js'
].concat(CUSTOMIZATION_URLS);

for(var i = 0; i < scribeUrls.length; i++) {
  var url = scribeUrls[i];
  if(url == null)
    continue;
  if(url.substring(0, 1) == '?') {
    url = url.substring(1);
    if(!confirm('Use rules from ' + url + '?')) {
      url = null;
    }
    CUSTOMIZATION_URLS[i - scribeUrls.length + CUSTOMIZATION_URLS.length] = url;
    if(url == null)
      continue;
  }
  document.write('<script src="' + url + '">' + CLOSE_TAG);
}

-->
</script>

</head>
<body onload="document.bgColor=BACKGROUND;Scribe();">

<script>
  document.write('<img src="' + LOGO_URL + '"/><br/>');
</script>
Scribe is running from this window.  Please leave it open until you are done
using Scribe.

</html>
